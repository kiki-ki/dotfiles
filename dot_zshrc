#!/bin/sh

### Init ###

[ -f /opt/homebrew/bin/brew ] && eval "$(/opt/homebrew/bin/brew shellenv)"

eval "$(starship init zsh)"

if command -v direnv >/dev/null 2>&1; then
  eval "$(direnv hook zsh)"
fi

# sheldon
autoload -U compinit; compinit
export SHELDON_DATA_DIR="$HOME/.config/sheldon"
eval "$(sheldon source)"

# fzf
export FZF_DEFAULT_OPTS=$(cat <<'EOF'
--height '80%'
--reverse
--border=rounded
--preview '
  if [ -d {} ]; then
    eza --tree --level=2 --git --color=always {}
  else
    bat --color=always --style=numbers,grid --line-range=:500 {}
  fi
'
EOF
)
export FZF_CTRL_R_OPTS="--no-preview"

. <(fzf --zsh)

# asdf
if command -v asdf >/dev/null 2>&1; then
  export PATH="${ASDF_DATA_DIR:-$HOME/.asdf}/shims:$PATH"
fi

## go
if command -v go >/dev/null 2>&1; then
  export PATH="$PATH":"$(go env GOPATH)"/bin
fi

### Aliases ###

# cd
alias ..="cd .."
alias ...="cd ../.."
alias ....="cd ../../.."
alias .....="cd ../../../.."

# cat
alias cat="bat --style=plain --paging=never"

# ls
alias l='eza --git'
alias ll='eza --git --long --header --all'
alias lt='eza --git --tree --level=2'

# git
alias g="git"
alias gb="g branch"
alias gd="g diff"
alias ga="g add"
alias gc="g commit"
alias gf="g fetch"
alias gst="g status"
alias gco="g checkout"
alias gcp="g cherry-pick"

# docker
alias d="docker"
alias dc="docker compose"

# terraform
alias tf="terraform"

# bundler
alias be="bundle exec"
alias bi="bundle install"
alias bu="bundle update"

# k8s
alias k="kubectl"

### Envs ###

export EDITOR=vi
export VISUAL=vi
export PAGER=less

### Final ###

[ -f ~/.zshrc.local ] && . ~/.zshrc.local

